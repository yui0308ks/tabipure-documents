<!-- TOC -->

- [ER図について](#aboutERdiagram)

<!-- /TOC -->

## aboutERdiagram
- ER図の書き方には何種類かフォーマットがあるが、主に代表的なIDEF1X（ｱｲﾃﾞﾌﾜﾝｴｯｸｽ）とIE表記法がある。
- リレーショナルデータベースにおけるテーブル間の関係は、基本的に「１対多」の関連に分解する。
- 「多対多」を「１対多」に分解するときに必要になるエンティティを「関連実体」と呼ぶ。
- Entity-Relationship Diagram:実体関連図


## 第三正規形テーブル同士の関連を見抜く

社員

| 会社コード | 社員ID | 社員名 | 年齢  | 部署コード |
| ----- | ---- | --- | --- | ----- |
| C0001 | 000A | 加藤  | 40  | D01   |
| C0001 | 000B | 藤本  | 32  | D02   |
| C0001 | 001F | 三島  | 50  | D03   |
| C0002 | 000A | 斉藤  | 47  | D03   |
| C0002 | 009F | 田島  | 25  | D01   |
| C0002 | 010A | 渋谷  | 33  | D04   |

会社

| 会社コード | 会社名 |
| ----- | --- |
| C0001 | A商事 |
| C0002 | B化学 |
| C0003 | C建設 |

部署

| 部署コード | 部署名 |
| ----- | --- |
| D01   | 開発  |
| D02   | 人事  |
| D03   | 営業  |
| D04   | 総務  |


テーブル同士の間では、一般に次の３パターンの関連がありうる
- １対１
    - あまり見かけない。２つのテーブルの主キーが一致するケースであり、普通は１つのテーブルにまとめてしまっても問題ない。
    - 少なくとも正規化の過程でこのような１対１のテーブルが作られることはない
- １対多
    - 基本的に正規化によって生まれる関連はこのカテゴリに属す。
- 多対多
    - リレーショナルデータベースのお約束として、この多対多の関連は作ってはならない。


下記の５つのテーブルを、ER図で記述する。
また、関連エンティティが含まれているので、それがどれかも答える

支社

| 支社コード | 支社名 |
| ----- | --- |
| 001   | 東京  |
| 002   | 大阪  |

支店

| 支社コード | 支店コード | 支店名 |
| ----- | ----- | --- |
| 001   | 01    | 渋谷  |
| 001   | 02    | 八重洲 |
| 002   | 01    | 堺   |
| 002   | 02    | 豊中  |

商品

| 商品コード | 商品名  | 商品分類コード |
| ----- | ---- | ------- |
| 001   | 石鹸   | C1      |
| 002   | タオル  | C1      |
| 003   | 歯ブラシ | C1      |
| 004   | コップ  | C1      |
| 005   | 箸    | C2      |
| 006   | スプーン | C2      |
| 007   | 雑誌   | C3      |
| 008   | 爪切り  | C4      |

商品分類

| 商品分類コード | 分類名  |
| ------- | ---- |
| C1      | 水洗用品 |
| C2      | 食器   |
| C3      | 書籍   |
| C4      | 日用雑貨 |

支社支店商品

| 支社コード | 支店コード | 商品コード |
| ----- | ----- | ----- |
| 001   | 01    | 001   |
| 001   | 01    | 002   |
| 001   | 01    | 003   |
| 001   | 02    | 002   |
| 001   | 02    | 003   |
| 001   | 02    | 004   |
| 001   | 02    | 005   |
| 001   | 02    | 006   |
| 002   | 01    | 001   |
| 002   | 01    | 002   |
| 002   | 02    | 007   |
| 002   | 02    | 008   |


```uml
@startuml
title ER図の例

entity 支社{
  * 支社コード
  --
  * 支社名
}

entity 支店{
  * 支社コード
  * 支店コード
  --
  * 支店名
}

entity 支店商品{
  * 支社コード
  * 支店コード
  * 商品コード
}

entity 商品{
  * 商品コード
  --
  * 商品名
  * 商品分類コード
}

entity 商品分類{
  * 商品分類コード
  --
  * 分類名
}


支社 ||..|{ 支店
支店 ||..|{ 支店商品
商品 ||..|{ 支店商品
商品 }|..|| 商品分類

@enduml
```
関連エンティティ：「支店商品」エンティティ

