<!-- TOC -->

- [settlement](#settlement)
- [eRExample](#eRExample)

<!-- /TOC -->

#### settlement

決済システムについて学んだことを取りまとめていく。
参考にしたサイト：https://shiodaifuku.io/articles/FkPnu4HUemFFx8hnZCDZ

- 決済システムを作るときは、 ユーザ（のモデル）とお財布（のモデル）を分ける という設計を取り入れていただきたいと思います。
- 「ユーザ」
  - 一般的なユーザアカウントを表すモデルを指します。 現実世界において1人の個人に相当する、システムの各利用者に１つずつ与えられる人格にあたる概念です。
  - これは特に説明することもありませんが、おなじみの存在なので問題ないと思います。
- 「お財布」
  - 現実の世界における、お財布や口座に相当するモデルです。 お金やクレジットカードなどの支払手段を保管しておくものです。
  - サブスクリプションモデルの場合は現実世界にちょうどよい概念が見当たらないのですが、 支払手段とサブスクリプション契約を紐付けるモデルになります。
- 「分ける」
  - ユーザとお財布を別個の概念としてモデル化すること
  - ユーザとお財布のリレーションの多重度をN:1とすること
  
#### eRExample
- 良い例

```uml

@startuml

title ユーザとお財布のリレーション

entity ユーザ{
  * id
  * walletId
}

entity お財布{
  * id
  * creditCardId
}

entity クレジットカード{
  * id
}

ユーザ }|..|| お財布
お財布 ||..|{ クレジットカード

@enduml

```


```uml

@startuml
title サブスクリプションモデル

entity ユーザ{
  * id
  * accountId
}

entity アカウント{
  * id
  * 支払い手段の情報
}

entity リレーション{
  * id
  * accountId
  * subscriptionId
}

entity サブスクリプション{
  * id
  * 契約情報
}

ユーザ }|..|| アカウント
アカウント ||..|{ リレーション
リレーション }|..|| サブスクリプション

@enduml

```

