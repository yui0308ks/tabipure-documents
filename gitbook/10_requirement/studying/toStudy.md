# Action Items

<!-- TOC -->

- [Action Items](#v13-action-items)
  - [Requirement list](#requirement-list)
  - [logicDesign論理設計](#logic-design論理設計)
  - [physicalDesign物理設計](#Physical-Design論理設計)
  - [logicDesign論理設計](#logic-design論理設計)
  - [Three-tier schema３層スキーマ](#３層スキーマ)
    - [External schema外部スキーマ](#外部スキーマ)
    - [Conceptual schema概念スキーマ](#概念スキーマ)
    - [Internal schema内部スキーマ](#内部スキーマ)
  - [Logical design and physical design論理設計と物理設計](#論理設計と物理設計)
    - [Logial design論理設計](#論理設計)
    - [Physical design物理設計](#物理設計)

<!-- /TOC -->

## Requirement list

### Arrangement
主に取り決めることは下記の通り
- 論理設計
  - DB設計
- 物理設計
※DB設計について、勉強しながら設計していく。
勉強したこともこちらにまとめていく

### logicdesign論理設計
- 正規化
- ER図

### PhysicalDesign物理設計
- サーバ
- ストレージ

### DB設計について
- 情報はデータと文脈を合成して生まれる<br>
システムとは、このデータと情報の区別という観点から見た場合、<br>
ユーザーがシステムにデータを登録し、さらにそれを引き出して情報を作り出す<br>
という一連のサイクルの中に位置付けることもできる<br>

```uml
@startuml
title システムのサイクル

skinparam ParticipantPadding 10
skinparam BoxPadding 10

actor "ユーザー" as user
actor "ユーザー" as user2
database "DBMS"

    user -> DBMS: 登録
    DBMS -> (情報): 抽出(観点や文脈)
    (情報) -> user2

@enduml
```

- データ中心アプローチ
* DOA（Data Oriented Approach:DOA）
システムを作る際にプログラムよりも前にデータの設計から始める方法論<br>
スローガン的に言えば、「最初にデータありき」<br>
反対は、プロセス中心アプローチPOA（Process Oriented Approach）<br>

<br>
DOA：データ⇨プログラム<br>
POA：プログラム⇨データ<br>
<br>

プロセス（業務処理）というのは短期間で大きく変わっていくことが頻繁にあり、<br>
プロセス単位でデータ設計を行うことになるため、<br>
複数のプロセスで同じデータをデータを別個荷物などの冗長性が生じることになり、不都合が多くなる<br>
<br>

DOAは、POAの欠点を克服するために登場した。<br>
着眼のポイントは、データがあまり変化しない（永続的）という点

データの意味や形式が先に決まっていれば、<br>
複数のプログラムで強要することも容易で、業務要件の仕様変更にも柔軟に対応できる<br>
<br>
* 最初にデータがあり、プログラムはその次にできる

### ３層スキーマ
スキーマ（schema）
「枠組み」や「構図」という意味。
データベース設計においては、データ構造やフォーマットという意味で使う。
データベース設計のステップは、このスキーマのレベルと密接に結びついている。
スキーマは主に３つのレベルに分けられる

1. 外部スキーマ（外部モデル）ビューの世界
2. 概念スキーマ（論理データモデル）テーブルの世界
3. 内部スキーマ（物理データモデル）ファイルの世界

この三つのスキーマに基づいてシステムを記述したモデルを「３層スキーマモデルという」

#### 外部スキーマ
システムの利用者であるユーザから見て、データベースがどのような機能と
インタフェースを持っているかを定義するスキーマ。<br>
「ユーザから見たデータベース」の姿。<br>
データベースのオブジェクトとしては、ビューが相当する。<br>
このスキーマは、データベースだけでなく、画面のユーザインタフェースや入力データなど、<br>
ユーザから見える「システムの姿」の一部である、と言える。

#### 概念スキーマ
* データベースに保持するデータの要素及び、データ同士の関係を記述するスキーマ。
* 外部スキーマがユーザから見たデータベースだとすれば、概念スキーマは「開発者から見たデータベース」
* データベース設計において重要な位置を占めることになる。
* 概念スキーマの設計を「論理設計」とも呼ぶ。データベース設計の中心となるスキーマ。
* 小規模のシステム開発だと、概念スキーマを外部/内部スキーマに吸収させてしまう「２層スキーマ」も存在する。
* 2層スキーマは変更に対する柔軟性が低い
* 外部スキーマと内部スキーマの間に位置することでスキーマ同士の独立性を高め互いに影響し合わないようにするための
緩衝材の役割を果たす（データ独立性）
* 概念スキーマはデータ独立性を保証するためにある


#### 内部スキーマ
概念スキーマで定義された論理データベースを、具体的にどうDBMS内部に格納するかを定義するスキーマ<br>
テーブルやインデックスの物理的定義を含む。リレーショナルデータベースもコンピュータ上で動く以上、あらゆるデータは最終的に「ファイル」の形で管理され、その「ファイル」で表現される世界である。<br>
内部スキーマの設計を、論理設計との対比で「物理設計」と呼ぶ。


### 論理設計と物理設計
- 論理設計は物理設計に先立つ
- DBMSはユーザーにファイルを極力意識させないようにしているが、設計者はファイルレベルで考えるのが物理設計のポイント

#### 論理設計
- 概念スキーマを定義する設計を、論理設計と呼ぶ
- 「論理」の意味は、「物理層の制約にとらわれない」という意味。
- 物理層の制約とは、データベースサーバーのCPUパワーや、ストレージのデータ格納場所や、DBMSで使えるデータ型やSQLの構文といった、より具体的で実装レベルの条件のこと。最初にデータベース設計を行う際は、こうした物理層の制約は脇に置いて進める。

##### 論理設計のステップ
- entityは日本語で「実体」と訳す
- 現実世界に存在するデータの集合体を指す言葉
- 具体的には「顧客」や「社員」「店舗」「車」といった、物理的実態を伴ったもの
- 「税」や「会社」「注文履歴」のように物理的実体を伴わない、概念としてしか存在しないもの
- RDBMSではこうした現実世界のエンティティを最終的に「テーブル」という物理的単位で格納する
- このタスクの一部は「要件定義」と重なっている。
- どのようなエンティティが必要になるか、という問いは、要するにどういうデータを扱いたいか、という問いの変形である

```uml
@startuml
title 論理設計の４つのタスク

start
partition Initialization {
:1.エンティティの抽出;
:2.エンティティの定義;
:3.正規化;
:4.ER図の作成;
}
stop

@enduml
```

##### エンティティの定義
- エンティティを抽出した後は、各エンティティがどのようなデータを保持するかを決める。
- データを「属性（attribute）」という形で保持する。これは「列」と同義

##### 正規化
- 正規化（normalization）は、テーブル（entity）について、システムでの利用がスムーズに行えるように整理する作業。
- 正規化はCRUDが整合的に行えるように、エンティティのフォーマットを整理することが重要な目的。
- 正規化は、データベースの論理設計を理解する鍵と言っても過言ではない

##### ER図の作成
- Entity-Relationship Diagramの略。

```uml
@startuml
title ER図の例

entity 会社{
  * 会社コード
  --
  * 会社名
}
entity 社員{
  * 会社コード(FK)
  * 社員ID
  --
  * 社員名
  * 年齢
  * 部署コード(FK)
}
entity 部署{
  * 部署コード
  --
  * 部署名
}

会社 ||..|{ 社員
社員 }o..|| 部署

@enduml
```
#### 物理設計
- 物理設計は、論理設計の結果を受けて、データを格納するための物理的な領域や格納方法を決める工程
- 物理設計のステップ

```uml
@startuml
title 物理設計の５つのタスク

start
partition Initialization {
:1.テーブル定義;
:2.インデックス定義;
:3.ハードウェアのサイジング;
:4.ストレージの冗長構成決定;
:5.ファイルの物理配置決定;
}
stop

@enduml
```

##### テーブル定義
- 論理設計で定義された概念スキーマを元に、
それをDBMS内部に格納するための「テーブル」の単位に変換していく作業
- 論理設計で作られるERモデルを「論理モデル」と呼ぶのに対し、このフェーズで作られるモデルを「物理モデル」と呼ぶ

##### インデックス定義
- インデックス（索引）はRDBMSにおいてテーブルと並んで重要な概念。
- インデックスが重要な役割を果たすのは、非機能の部分、つまりパフォーマンス。

##### ハードウェアのサイジング
TBD

#### バックアップ設計
TBD

#### リカバリ設計
TBD